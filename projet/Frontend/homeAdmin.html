<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Doudix - Home</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="/projet/Frontend/javascript/services/servicesHttp.js"></script>
    <script src="/projet/Frontend/javascript/controllers/logoutCtrl.js"></script>
    <script src="/projet/Frontend/javascript/controllers/homeAdminCtrl.js"></script>
    <link rel="stylesheet" href="/projet/Frontend/css/style.css">
</head>

<!-- ðŸ”´ Modal pour bannir un utilisateur -->
<div id="banModal" class="modal">
    <div class="modal-content">
        <span class="close-modal" id="closeBanModal">&times;</span>
        <h3>Bannir un utilisateur</h3>
        <label for="userSelect">Utilisateur :</label>
        <select id="userSelect"></select>
        <label for="banReason">Remarque :</label>
        <textarea id="banReason" placeholder="Raison du bannissement..." rows="4"></textarea>
        <button id="banUserBtn">BAN</button>
    </div>
</div>

<!-- ðŸ”´ Script jQuery pour gÃ©rer la pop-up -->
<script>
    $(document).ready(function () {
        $("#openBanModal").click(function () {
            $("#banModal").fadeIn();

            getAllUsers(function (users) {
                const $select = $("#userSelect").empty();
                users.forEach(u => {
                    $select.append(`<option value="${u.username}">${u.username}</option>`);
                });
            });
        });

        $("#closeBanModal").click(function () {
            $("#banModal").fadeOut();
        });

        $("#banUserBtn").click(function () {
            const username = $("#userSelect").val();
            const remarque = $("#banReason").val();

            if (!remarque.trim()) {
                alert("Merci d'ajouter une remarque.");
                return;
            }

            banUser({ username, remarque }, function () {
                alert("Utilisateur banni avec succÃ¨s !");
                $("#banModal").fadeOut();
            }, function () {
                alert("Erreur lors du bannissement.");
            });
        });
    });
</script>


<body>
    <header class="topbar">
        <div class="logo">
            <img src="https://kazanjiana.emf-informatique.ch/133-Ressource/image.jpg" alt="Doudix Logo">
        </div>
        <div class="search-bar">
            <input type="text" id="searchInput" placeholder="Search">
        </div>
        <button class="ban-button" id="openBanModal">Ban Users</button>
        <div class="user-info">
            <span id="logged-username"></span>
            <img src="https://kazanjiana.emf-informatique.ch/133-Ressource/account-icon-sign-symbol-logo-design-free-vector.jpg"
                alt="User Icon">
            <button id="logoutButton" class="logoutButton">Logout</button>
        </div>
    </header>

    <main class="container">
        <aside class="sidebar">
            <a href="post.html" class="btn">+ Add Post</a>
            <button id="resetFilter" class="btn reset-btn">ðŸ”„ Reset Filter</button>
            <ul>
                <li>Gaming</li>
                <li>Food</li>
                <li>Fitness</li>
                <li>Travel</li>
                <li>Technology</li>
                <li>Fashion</li>
                <li>Music</li>
                <li>Movies & Series</li>
                <li>Memes</li>
                <li>Sports</li>
                <li>Books</li>
                <li>Photography</li>
                <li>Anime & Manga</li>
                <li>DIY & Crafts</li>
                <li>Motivation</li>
            </ul>
        </aside>

        <section class="post-list" id="post-list">
            <!-- Les posts seront ajoutÃ©s dynamiquement ici -->
        </section>
    </main>
</body>

</html>